Made changes in chp 3 in second branch.